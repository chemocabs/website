<section class="ride-request" id="ride-request" aria-labelledby="ride-heading">
  <div class="ride-request__orbs" aria-hidden="true">
    <div class="ride-request__orb ride-request__orb--1"></div>
    <div class="ride-request__orb ride-request__orb--2"></div>
  </div>
  <div class="container" style="position: relative; z-index: 2;">
    <!-- Success State -->
    <div id="ride-success" class="ride-request__success" style="display: none;">
      <div class="ride-request__success-icon">‚úÖ</div>
      <h2>Thank you!</h2>
      <p>We'll be in touch within 24 hours to confirm your ride.</p>
      <p class="ride-request__success-sub">You are not alone. ü©∑</p>
    </div>

    <div class="ride-request__grid" id="ride-grid">
      <div class="ride-request__info">
        <h2 class="ride-request__heading" id="ride-heading">
          {{ section.settings.heading }}
        </h2>
        <p class="ride-request__body">
          {{ section.settings.subheading }}
        </p>
        <ul class="ride-request__features">
          {%- for block in section.blocks -%}
            {% if block.type == 'feature' %}
              <li>{{ block.settings.text }}</li>
            {% endif %}
          {%- endfor -%}
        </ul>

        <div class="ride-request__coverage card">
          <h4 class="ride-request__coverage-title">Service Coverage</h4>
          <p class="ride-request__coverage-text">
            Chemo Cabs currently provides direct volunteer and rideshare services throughout the **Greater Toronto Area (GTA)** and neighboring regions. To ensure no patient is left waiting, we are expanding our reach Canada-wide by coordinating and funding rides through Uber, Lyft, and Hopp in all other cities.
          </p>
          <div class="ride-request__urgent">
            <strong>Need an immediate ride?</strong><br>
            Contact us directly at <a href="tel:4169309424">416-930-9424</a> or <a href="mailto:chemocabs@gmail.com">chemocabs@gmail.com</a>
          </div>
        </div>
      </div>

      <div class="ride-request__form-card">
        <h3 class="ride-request__form-title">Request Your Free Ride</h3>
        <p class="ride-request__form-sub">We'll confirm within 24 hours.</p>


        <form id="ride-form" noValidate>
          {%- liquid
            assign form_blocks = section.blocks | where: "type", "text_input" | first
            if form_blocks == nil
              assign form_blocks = section.blocks | where: "type", "email_input" | first
            endif
            if form_blocks == nil
              assign form_blocks = section.blocks | where: "type", "tel_input" | first
            endif
            if form_blocks == nil
              assign form_blocks = section.blocks | where: "type", "select_input" | first
            endif
            if form_blocks == nil
              assign form_blocks = section.blocks | where: "type", "textarea_input" | first
            endif
            if form_blocks == nil
              assign form_blocks = section.blocks | where: "type", "html_block" | first
            endif
            if form_blocks == nil
              assign form_blocks = section.blocks | where: "type", "@app" | first
            endif
          -%}

          {%- if form_blocks -%}
            {%- for block in section.blocks -%}
              {%- case block.type -%}
                {%- when 'text_input' -%}
                  <div class="form-group" {{ block.shopify_attributes }}>
                    <label class="form-label">{{ block.settings.label }}{% if block.settings.required %} *{% endif %}</label>
                    <input name="{{ block.settings.label | handleize }}" type="text" class="form-input form-input-dark" {% if block.settings.required %}required{% endif %} placeholder="{{ block.settings.placeholder }}">
                  </div>
                {%- when 'email_input' -%}
                  <div class="form-group" {{ block.shopify_attributes }}>
                    <label class="form-label">{{ block.settings.label }}{% if block.settings.required %} *{% endif %}</label>
                    <input name="email" type="email" class="form-input form-input-dark" {% if block.settings.required %}required{% endif %} placeholder="{{ block.settings.placeholder }}">
                  </div>
                {%- when 'tel_input' -%}
                  <div class="form-group" {{ block.shopify_attributes }}>
                    <label class="form-label">{{ block.settings.label }}{% if block.settings.required %} *{% endif %}</label>
                    <input name="phone" type="tel" class="form-input form-input-dark" {% if block.settings.required %}required{% endif %} placeholder="{{ block.settings.placeholder }}">
                  </div>
                {%- when 'select_input' -%}
                  <div class="form-group" {{ block.shopify_attributes }}>
                    <label class="form-label">{{ block.settings.label }}</label>
                    <select name="{{ block.settings.label | handleize }}" class="form-input form-input-dark">
                      {% assign options = block.settings.options | split: ',' %}
                      {% for option in options %}
                        <option value="{{ option | strip | handleize }}">{{ option | strip }}</option>
                      {% endfor %}
                    </select>
                  </div>
                {%- when 'textarea_input' -%}
                  <div class="form-group" {{ block.shopify_attributes }}>
                    <label class="form-label">{{ block.settings.label }}</label>
                    <textarea name="{{ block.settings.label | handleize }}" class="form-input form-input-dark" rows="3" placeholder="{{ block.settings.placeholder }}"></textarea>
                  </div>
                {%- when 'html_block' -%}
                  <div class="form-group" {{ block.shopify_attributes }}>
                    {{ block.settings.html }}
                  </div>
                {%- when '@app' -%}
                  {% render block %}
              {%- endcase -%}
            {%- endfor -%}
          {%- else -%}
            {%- comment -%} Default Form Fallback {%- endcomment -%}
            <div class="form-group">
              <label class="form-label">Full Name *</label>
              <input name="name" class="form-input form-input-dark" required>
            </div>
            <div class="form-group">
              <label class="form-label">Email *</label>
              <input name="email" type="email" class="form-input form-input-dark" required>
            </div>
            <div class="form-group">
              <label class="form-label">Phone *</label>
              <input name="phone" type="tel" class="form-input form-input-dark" placeholder="(555) 123-4567" required>
            </div>
            <div class="form-group">
              <label class="form-label">City / Province *</label>
              <input name="city" class="form-input form-input-dark" required>
            </div>
            <div class="form-group">
              <label class="form-label">Treatment Facility *</label>
              <input name="facility" class="form-input form-input-dark" required>
            </div>
            <div class="form-group">
              <label class="form-label">Next Appointment Date *</label>
              <input name="date" type="date" class="form-input form-input-dark" required>
            </div>
            <div class="form-group">
              <label class="form-label">Ride Preference</label>
              <select name="preference" class="form-input form-input-dark">
                <option value="no-preference">No Preference</option>
                <option value="volunteer">Volunteer Driver</option>
                <option value="rideshare">Rideshare (Uber/Lyft/Hopp)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label">Notes</label>
              <textarea name="notes" class="form-input form-input-dark" rows="3" placeholder="Optional"></textarea>
            </div>
          {%- endif -%}

          <button type="submit" id="ride-submit" class="btn btn-pink btn-lg btn-full">
            Submit Ride Request ‚Üí
          </button>
          <p class="ride-request__secure">üîí Your information is confidential and secure.</p>
        </form>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Ride Request",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "You Focus on Getting Better. We'll Handle the Ride." },
    { "type": "textarea", "id": "subheading", "label": "Subheading", "default": "Whether it's chemo, radiation, or surgery - submit a request and we'll take care of the rest." }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature List Item",
      "settings": [
        { "type": "text", "id": "text", "label": "Feature Text", "default": "üöó Volunteer drivers or rideshare" }
      ]
    },
    {
      "type": "text_input",
      "name": "Text Input",
      "settings": [
        { "type": "text", "id": "label", "label": "Label", "default": "Full Name" },
        { "type": "text", "id": "placeholder", "label": "Placeholder" },
        { "type": "checkbox", "id": "required", "label": "Required", "default": true }
      ]
    },
    {
      "type": "email_input",
      "name": "Email Input",
      "settings": [
        { "type": "text", "id": "label", "label": "Label", "default": "Email Address" },
        { "type": "text", "id": "placeholder", "label": "Placeholder" },
        { "type": "checkbox", "id": "required", "label": "Required", "default": true }
      ]
    },
    {
      "type": "tel_input",
      "name": "Phone Input",
      "settings": [
        { "type": "text", "id": "label", "label": "Label", "default": "Phone Number" },
        { "type": "text", "id": "placeholder", "label": "Placeholder", "default": "(555) 123-4567" },
        { "type": "checkbox", "id": "required", "label": "Required", "default": true }
      ]
    },
    {
      "type": "select_input",
      "name": "Select Input",
      "settings": [
        { "type": "text", "id": "label", "label": "Label", "default": "Ride Preference" },
        { "type": "textarea", "id": "options", "label": "Options (Comma separated)", "default": "No Preference, Volunteer Driver, Rideshare" }
      ]
    },
    {
      "type": "textarea_input",
      "name": "Textarea Input",
      "settings": [
        { "type": "text", "id": "label", "label": "Label", "default": "Notes" },
        { "type": "text", "id": "placeholder", "label": "Placeholder", "default": "Optional" }
      ]
    },
    {
      "type": "html_block",
      "name": "Custom HTML",
      "settings": [
        { "type": "html", "id": "html", "label": "HTML Code" }
      ]
    },
    {
      "type": "@app"
    }
  ],
  "presets": [
    {
      "name": "Ride Request",
      "blocks": [
        { "type": "feature", "settings": { "text": "üöó Volunteer drivers or rideshare - your choice" } },
        { "type": "feature", "settings": { "text": "üí∞ Always 100% free for patients" } },
        { "type": "feature", "settings": { "text": "üè• Rides to any cancer treatment facility in Canada" } }
      ]
    }
  ]
}
{% endschema %}

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('ride-form');
    const grid = document.getElementById('ride-grid');
    const success = document.getElementById('ride-success');
    const submitBtn = document.getElementById('ride-submit');

    if (form) {
      form.addEventListener('submit', (e) => {
        e.preventDefault();
        submitBtn.textContent = 'Submitting...';
        submitBtn.disabled = true;
        
        setTimeout(() => {
          grid.style.display = 'none';
          success.style.display = 'block';
          if (success.scrollIntoView) {
            success.scrollIntoView({ behavior: 'smooth' });
          }
        }, 1500);
      });
    }
  });
</script>

