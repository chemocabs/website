<section class="what-we-do" id="what-we-do" aria-labelledby="what-we-do-heading">
  <div class="container">
    <div class="text-center fade-up">
      <p class="section-label">WHAT WE DO</p>
      <h2 class="section-heading" id="what-we-do-heading">{{ section.settings.heading }}</h2>
    </div>

    <div class="what-we-do__grid stagger-children">
      {%- if section.blocks.size > 0 -%}
        {%- for block in section.blocks -%}
          <div class="what-we-do__card card fade-up hover-lift" {{ block.shopify_attributes }}>
            <div class="what-we-do__visual">
              {%- if block.settings.image != blank -%}
                {{ block.settings.image | image_url: width: 400 | image_tag: 
                  loading: 'lazy',
                  class: 'what-we-do__img',
                  widths: '200, 300, 400',
                  alt: block.settings.title
                }}
              {%- else -%}
                <span class="what-we-do__icon" aria-hidden="true">{{ block.settings.icon }}</span>
              {%- endif -%}
            </div>
            <h3 class="what-we-do__title">{{ block.settings.title }}</h3>
            <p class="what-we-do__desc">{{ block.settings.description }}</p>
          </div>
        {%- endfor -%}
      {%- else -%}
        {%- comment -%} Default Content Fallback {%- endcomment -%}
        <div class="what-we-do__card card fade-up hover-lift">
          <div class="what-we-do__visual"><span class="what-we-do__icon" aria-hidden="true">üöó</span></div>
          <h3 class="what-we-do__title">Volunteer Drivers</h3>
          <p class="what-we-do__desc">Compassionate community volunteers provide door-to-door rides to and from treatment centres across Canada. Avoid the stress of driving while being supported by your community.</p>
        </div>
        <div class="what-we-do__card card fade-up hover-lift">
          <div class="what-we-do__visual"><span class="what-we-do__icon" aria-hidden="true">üì±</span></div>
          <h3 class="what-we-do__title">Rideshare Coverage</h3>
          <p class="what-we-do__desc">We coordinate and pay for Uber, Lyft, and Hopp rides for patients when volunteer drivers are unavailable. Seamless, stress-free transportation regardless of location.</p>
        </div>
        <div class="what-we-do__card card fade-up hover-lift">
          <div class="what-we-do__visual"><span class="what-we-do__icon" aria-hidden="true">üéÅ</span></div>
          <h3 class="what-we-do__title">Comfort Bags</h3>
          <p class="what-we-do__desc">Our Deluxe Comfort Bags are filled with oncology-recommended items to provide relief and warmth during treatment. Because we care about your comfort relative to the ride.</p>
        </div>
      {%- endif -%}
    </div>
  </div>
</section>

<style>
  .what-we-do__visual {
    height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 24px;
    border-radius: var(--radius-lg);
    overflow: hidden;
  }

  .what-we-do__img {
    width: 80px;
    height: 80px;
    object-fit: contain;
    transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .what-we-do__card:hover .what-we-do__img {
    transform: scale(1.1) rotate(2deg);
  }

  .what-we-do__icon {
    font-size: 3.5rem;
  }

  /* Adjust card layout for images */
  .what-we-do__card {
    padding: 48px 32px;
    text-align: center;
  }
</style>

{% schema %}
{
  "name": "What We Do",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Three Ways We Drive Hope"
    }
  ],
  "blocks": [
    {
      "type": "service",
      "name": "Service Card",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Service Image",
          "info": "Upload a premium illustration or icon. If empty, Emoji will be used."
        },
        {
          "type": "text",
          "id": "icon",
          "label": "Fallback Emoji Icon",
          "default": "üöó"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Service Name"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "What We Do",
      "blocks": [
        {
          "type": "service",
          "settings": {
            "icon": "üöó",
            "title": "Volunteer Drivers",
            "description": "Compassionate community volunteers provide door-to-door rides to and from treatment centres across Canada. A friendly face on a tough day makes all the difference."
          }
        },
        {
          "type": "service",
          "settings": {
            "icon": "üì±",
            "title": "Rideshare Coverage",
            "description": "We cover Uber, Lyft, Hopp, and other rideshare costs so patients can get to treatment on their schedule - no wallet required, no stress involved."
          }
        },
        {
          "type": "service",
          "settings": {
            "icon": "üéÅ",
            "title": "Comfort Bags",
            "description": "Our Deluxe Comfort Bags are packed with oncology-recommended essentials - from cozy blankets to nausea relief - because care extends beyond the ride."
          }
        }
      ]
    }
  ]
}
{% endschema %}
